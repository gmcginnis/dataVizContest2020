---
title: "day01"
author: "Gillian McGinnis"
date: "11/10/2020"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(ggrepel)
library(janitor)
library(ggthemes)
library(wesanderson)
```

```{r dataframes}
# Loading data; source: https://github.com/Reed-Statistics/data-viz-competition-2020
rm(list = ls())

diversity_school <- 
  read_csv("https://raw.githubusercontent.com/Reed-Statistics/data-viz-competition-2020/main/data/diversity_school.csv") %>%
  dplyr::select(-X1)

historical_tuition <- 
  read_csv("https://raw.githubusercontent.com/Reed-Statistics/data-viz-competition-2020/main/data/historical_tuition.csv") %>%
  dplyr::select(-X1)

salary_potential <-
  read_csv("https://raw.githubusercontent.com/Reed-Statistics/data-viz-competition-2020/main/data/salary_potential.csv") %>%
  dplyr::select(-X1)

tuition_cost <-
  read_csv("https://raw.githubusercontent.com/Reed-Statistics/data-viz-competition-2020/main/data/tuition_cost.csv") %>% 
  dplyr::select(-X1)

tuition_income <-
  read_csv("https://raw.githubusercontent.com/Reed-Statistics/data-viz-competition-2020/main/data/tuition_income.csv") %>%
  dplyr::select(-X1)
```

```{r plots}
filtered_diversity <- diversity_school %>%
  filter(name == "University of Arizona") %>%
  filter(category != "Women",
         category != "Total Minority")

ggplot(filtered_diversity, aes(x = category, y = enrollment))+
  geom_point()



filtered_cost <- tuition_cost %>%
  filter(state_code == "AZ",
         type == "For Profit")

ggplot(filtered_cost, aes(x = name, y = in_state_total))+
  geom_point()


filtered_potential <- salary_potential %>%
  filter(state_name == "Oregon") %>%
  select(!rank)

ggplot(filtered_potential, aes(x = make_world_better_percent, y = stem_percent, label = name))+
  geom_point()+
  geom_text_repel(size=2)
  #geom_text(position = "dodge", nudge = )
  #geom_label(aes(label = name), position = "dodge", check_overlap=TRUE, size=1)

ggplot(filtered_potential, aes(x = make_world_better_percent, y = mid_career_pay, label = name))+
  geom_point(aes(y = early_career_pay))+
  geom_point(aes(y = mid_career_pay))+
  geom_text_repel(size = 2)


filtered_longer <- filtered_potential %>%
  pivot_longer(cols = ends_with("pay"), names_to = "time", values_to = "pay") %>%
  group_by(name)

ggplot(filtered_longer, aes(x = make_world_better_percent, y = pay, label = name, color = time, group = name))+
  geom_line(color = "green")+
  geom_point()


ggplot(salary_potential, aes(x = early_career_pay, y = mid_career_pay, color = state_name))+
  geom_point(alpha=.3)


combinedDivSal <- full_join(diversity_school, salary_potential)

combinedDivSalFiltered <- combinedDivSal %>%
  clean_names("small_camel") %>%
  drop_na() %>%
  filter(category %in% c("Total Minority", "White")) %>%
  group_by(name) %>%
  filter(state == "Arizona")

ggplot(combinedDivSalFiltered, aes(x = makeWorldBetterPercent, y = enrollment, color = category))+
  geom_point()

combinedGender <- combinedDivSal %>%
  clean_names("small_camel") %>%
  drop_na() %>%
  filter(category == "Women") %>%
  mutate(men = totalEnrollment - enrollment) %>%
  select(!c(totalEnrollment, category)) %>%
  rename(women = enrollment) %>%
  pivot_longer(cols = c(women, men), names_to = "gender", values_to = "pop")

combinedGenderFiltered <- combinedGender %>%
  filter(state == "California") %>%
  mutate(salChange = (((midCareerPay - earlyCareerPay)/earlyCareerPay)*100))

ggplot(combinedGenderFiltered, aes(x = salChange, y = pop, color = gender, group = name))+
  geom_point()+
  geom_line(color = "green")+
  scale_color_manual(values = c("women" = "deeppink", "men" = "blue"))
  
```

```{r tuition}
histTuition <- historical_tuition %>%
  clean_names("small_camel") %>%
  filter(tuitionType == c("All Constant", "All Current")) %>%
  unite("both", c(tuitionType, type), remove = FALSE)
  # mutate(years = case_when(
  #   tuitionType == str_detect("2 Year") ~ "2 Year",
  #   tutionType == str_detect("4 Year") ~ "4 Year"
  # ))

money <- salary_potential %>%
  summary(mean = mean(mid_career_pay))

ggplot(histTuition, aes(x = year, y = tuitionCost, color = type, shape = tuitionType, group = type))+
  geom_point()+
  geom_line(aes(group = both))+
  #geom_line()+
  theme_few()+
  theme(axis.text.x = element_text(angle = 30,
                                   vjust = 0.7))
```


```{r heatmap}
ggplot(tuition_cost, aes(x = type, y = state_code, fill = out_of_state_total))+
  geom_tile()

cut_diversity <- diversity_school %>%
  filter(category != "White",
         category != "Women",
         category != "Total Minority") %>%
  group_by(state) %>%
  filter(state %in% c("Arizona", "Alabama", "California", "Oregon", "New York", "New Mexico"))

ggplot(cut_diversity, aes(x = category, y = state, fill = enrollment))+
  #geom_bin2d()
  geom_tile()
  #geom_raster()
#sad

```

```{r maps}
ggplot(tuition_cost, aes(fill = out_of_state_total, map_id = state))+
  geom_map(map = map_data("state"))

states_map <- as.data.frame(apply(map_data("state"),2,str_to_title)) %>%
  rename(state = region)

tuition_map <- left_join(states_map, tuition_cost, by = "state") %>%
  group_by(long, lat)

ggplot(tuition_map, aes(x=long, y=lat))+
  geom_polygon(aes(fill = out_of_state_total))
#whelp it's getting there
```


